{"version":3,"sources":["../../src/accessibility/AccessibilityManager.js"],"names":["core","utils","mixins","delayMixin","DisplayObject","prototype","KEY_CODE_TAB","DIV_TOUCH_SIZE","DIV_TOUCH_POS_X","DIV_TOUCH_POS_Y","DIV_TOUCH_ZINDEX","DIV_HOOK_SIZE","DIV_HOOK_POS_X","DIV_HOOK_POS_Y","DIV_HOOK_ZINDEX","AccessibilityManager","renderer","tablet","phone","navigator","isCocoonJS","createTouchHook","div","document","createElement","style","width","height","position","top","left","zIndex","pool","renderId","debug","children","_onKeyDown","bind","_onMouseMove","isActive","isMobileAccessabillity","window","addEventListener","hookDiv","backgroundColor","title","activate","body","removeChild","appendChild","removeEventListener","on","update","view","parentNode","deactivate","off","updateAccessibleObjects","displayObject","visible","accessible","interactive","_accessibleActive","addChild","i","length","renderingToScreen","_lastObjectRendered","rect","getBoundingClientRect","sx","sy","child","removeItems","_accessibleDiv","push","hitArea","wt","worldTransform","tx","x","a","ty","y","d","getBounds","capHitArea","pop","borderStyle","_onClick","_onFocus","_onFocusOut","accessibleTitle","accessibleHint","tabIndex","setAttribute","e","interactionManager","plugins","interaction","dispatchEvent","target","eventData","keyCode","destroy","WebGLRenderer","registerPlugin","CanvasRenderer"],"mappings":"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","file":"AccessibilityManager.js","sourcesContent":["import * as core from '../core';\nimport Device from 'ismobilejs';\nimport accessibleTarget from './accessibleTarget';\n\n// add some extra variables to the container..\ncore.utils.mixins.delayMixin(\n    core.DisplayObject.prototype,\n    accessibleTarget\n);\n\nconst KEY_CODE_TAB = 9;\n\nconst DIV_TOUCH_SIZE = 100;\nconst DIV_TOUCH_POS_X = 0;\nconst DIV_TOUCH_POS_Y = 0;\nconst DIV_TOUCH_ZINDEX = 2;\n\nconst DIV_HOOK_SIZE = 1;\nconst DIV_HOOK_POS_X = -1000;\nconst DIV_HOOK_POS_Y = -1000;\nconst DIV_HOOK_ZINDEX = 2;\n\n/**\n * The Accessibility manager reacreates the ability to tab and and have content read by screen\n * readers. This is very important as it can possibly help people with disabilities access pixi\n * content.\n *\n * Much like interaction any DisplayObject can be made accessible. This manager will map the\n * events as if the mouse was being used, minimizing the efferot required to implement.\n *\n * An instance of this class is automatically created by default, and can be found at renderer.plugins.accessibility\n *\n * @class\n * @memberof PIXI.accessibility\n */\nexport default class AccessibilityManager\n{\n    /**\n     * @param {PIXI.CanvasRenderer|PIXI.WebGLRenderer} renderer - A reference to the current renderer\n     */\n    constructor(renderer)\n    {\n        if ((Device.tablet || Device.phone) && !navigator.isCocoonJS)\n        {\n            this.createTouchHook();\n        }\n\n        // first we create a div that will sit over the pixi element. This is where the div overlays will go.\n        const div = document.createElement('div');\n\n        div.style.width = `${DIV_TOUCH_SIZE}px`;\n        div.style.height = `${DIV_TOUCH_SIZE}px`;\n        div.style.position = 'absolute';\n        div.style.top = `${DIV_TOUCH_POS_X}px`;\n        div.style.left = `${DIV_TOUCH_POS_Y}px`;\n        div.style.zIndex = DIV_TOUCH_ZINDEX;\n\n        /**\n         * This is the dom element that will sit over the pixi element. This is where the div overlays will go.\n         *\n         * @type {HTMLElement}\n         * @private\n         */\n        this.div = div;\n\n        /**\n         * A simple pool for storing divs.\n         *\n         * @type {*}\n         * @private\n         */\n        this.pool = [];\n\n        /**\n         * This is a tick used to check if an object is no longer being rendered.\n         *\n         * @type {Number}\n         * @private\n         */\n        this.renderId = 0;\n\n        /**\n         * Setting this to true will visually show the divs\n         *\n         * @type {boolean}\n         */\n        this.debug = false;\n\n        /**\n         * The renderer this accessibility manager works for.\n         *\n         * @member {PIXI.SystemRenderer}\n         */\n        this.renderer = renderer;\n\n        /**\n         * The array of currently active accessible items.\n         *\n         * @member {Array<*>}\n         * @private\n         */\n        this.children = [];\n\n        /**\n         * pre-bind the functions\n         *\n         * @private\n         */\n        this._onKeyDown = this._onKeyDown.bind(this);\n        this._onMouseMove = this._onMouseMove.bind(this);\n\n        /**\n         * stores the state of the manager. If there are no accessible objects or the mouse is moving the will be false.\n         *\n         * @member {Array<*>}\n         * @private\n         */\n        this.isActive = false;\n        this.isMobileAccessabillity = false;\n\n        // let listen for tab.. once pressed we can fire up and show the accessibility layer\n        window.addEventListener('keydown', this._onKeyDown, false);\n    }\n\n    /**\n     * Creates the touch hooks.\n     *\n     */\n    createTouchHook()\n    {\n        const hookDiv = document.createElement('button');\n\n        hookDiv.style.width = `${DIV_HOOK_SIZE}px`;\n        hookDiv.style.height = `${DIV_HOOK_SIZE}px`;\n        hookDiv.style.position = 'absolute';\n        hookDiv.style.top = `${DIV_HOOK_POS_X}px`;\n        hookDiv.style.left = `${DIV_HOOK_POS_Y}px`;\n        hookDiv.style.zIndex = DIV_HOOK_ZINDEX;\n        hookDiv.style.backgroundColor = '#FF0000';\n        hookDiv.title = 'HOOK DIV';\n\n        hookDiv.addEventListener('focus', () =>\n        {\n            this.isMobileAccessabillity = true;\n            this.activate();\n            document.body.removeChild(hookDiv);\n        });\n\n        document.body.appendChild(hookDiv);\n    }\n\n    /**\n     * Activating will cause the Accessibility layer to be shown. This is called when a user\n     * preses the tab key\n     *\n     * @private\n     */\n    activate()\n    {\n        if (this.isActive)\n        {\n            return;\n        }\n\n        this.isActive = true;\n\n        window.document.addEventListener('mousemove', this._onMouseMove, true);\n        window.removeEventListener('keydown', this._onKeyDown, false);\n\n        this.renderer.on('postrender', this.update, this);\n\n        if (this.renderer.view.parentNode)\n        {\n            this.renderer.view.parentNode.appendChild(this.div);\n        }\n    }\n\n    /**\n     * Deactivating will cause the Accessibility layer to be hidden. This is called when a user moves\n     * the mouse\n     *\n     * @private\n     */\n    deactivate()\n    {\n        if (!this.isActive || this.isMobileAccessabillity)\n        {\n            return;\n        }\n\n        this.isActive = false;\n\n        window.document.removeEventListener('mousemove', this._onMouseMove);\n        window.addEventListener('keydown', this._onKeyDown, false);\n\n        this.renderer.off('postrender', this.update);\n\n        if (this.div.parentNode)\n        {\n            this.div.parentNode.removeChild(this.div);\n        }\n    }\n\n    /**\n     * This recursive function will run throught he scene graph and add any new accessible objects to the DOM layer.\n     *\n     * @private\n     * @param {PIXI.Container} displayObject - The DisplayObject to check.\n     */\n    updateAccessibleObjects(displayObject)\n    {\n        if (!displayObject.visible)\n        {\n            return;\n        }\n\n        if (displayObject.accessible && displayObject.interactive)\n        {\n            if (!displayObject._accessibleActive)\n            {\n                this.addChild(displayObject);\n            }\n\n            displayObject.renderId = this.renderId;\n        }\n\n        const children = displayObject.children;\n\n        for (let i = children.length - 1; i >= 0; i--)\n        {\n            this.updateAccessibleObjects(children[i]);\n        }\n    }\n\n    /**\n     * Before each render this function will ensure that all divs are mapped correctly to their DisplayObjects.\n     *\n     * @private\n     */\n    update()\n    {\n        if (!this.renderer.renderingToScreen)\n        {\n            return;\n        }\n\n        // update children...\n        this.updateAccessibleObjects(this.renderer._lastObjectRendered);\n\n        const rect = this.renderer.view.getBoundingClientRect();\n        const sx = rect.width / this.renderer.width;\n        const sy = rect.height / this.renderer.height;\n\n        let div = this.div;\n\n        div.style.left = `${rect.left}px`;\n        div.style.top = `${rect.top}px`;\n        div.style.width = `${this.renderer.width}px`;\n        div.style.height = `${this.renderer.height}px`;\n\n        for (let i = 0; i < this.children.length; i++)\n        {\n            const child = this.children[i];\n\n            if (child.renderId !== this.renderId)\n            {\n                child._accessibleActive = false;\n\n                core.utils.removeItems(this.children, i, 1);\n                this.div.removeChild(child._accessibleDiv);\n                this.pool.push(child._accessibleDiv);\n                child._accessibleDiv = null;\n\n                i--;\n\n                if (this.children.length === 0)\n                {\n                    this.deactivate();\n                }\n            }\n            else\n            {\n                // map div to display..\n                div = child._accessibleDiv;\n                let hitArea = child.hitArea;\n                const wt = child.worldTransform;\n\n                if (child.hitArea)\n                {\n                    div.style.left = `${(wt.tx + (hitArea.x * wt.a)) * sx}px`;\n                    div.style.top = `${(wt.ty + (hitArea.y * wt.d)) * sy}px`;\n\n                    div.style.width = `${hitArea.width * wt.a * sx}px`;\n                    div.style.height = `${hitArea.height * wt.d * sy}px`;\n                }\n                else\n                {\n                    hitArea = child.getBounds();\n\n                    this.capHitArea(hitArea);\n\n                    div.style.left = `${hitArea.x * sx}px`;\n                    div.style.top = `${hitArea.y * sy}px`;\n\n                    div.style.width = `${hitArea.width * sx}px`;\n                    div.style.height = `${hitArea.height * sy}px`;\n                }\n            }\n        }\n\n        // increment the render id..\n        this.renderId++;\n    }\n\n    /**\n     * TODO: docs.\n     *\n     * @param {Rectangle} hitArea - TODO docs\n     */\n    capHitArea(hitArea)\n    {\n        if (hitArea.x < 0)\n        {\n            hitArea.width += hitArea.x;\n            hitArea.x = 0;\n        }\n\n        if (hitArea.y < 0)\n        {\n            hitArea.height += hitArea.y;\n            hitArea.y = 0;\n        }\n\n        if (hitArea.x + hitArea.width > this.renderer.width)\n        {\n            hitArea.width = this.renderer.width - hitArea.x;\n        }\n\n        if (hitArea.y + hitArea.height > this.renderer.height)\n        {\n            hitArea.height = this.renderer.height - hitArea.y;\n        }\n    }\n\n    /**\n     * Adds a DisplayObject to the accessibility manager\n     *\n     * @private\n     * @param {DisplayObject} displayObject - The child to make accessible.\n     */\n    addChild(displayObject)\n    {\n        //    this.activate();\n\n        let div = this.pool.pop();\n\n        if (!div)\n        {\n            div = document.createElement('button');\n\n            div.style.width = `${DIV_TOUCH_SIZE}px`;\n            div.style.height = `${DIV_TOUCH_SIZE}px`;\n            div.style.backgroundColor = this.debug ? 'rgba(255,0,0,0.5)' : 'transparent';\n            div.style.position = 'absolute';\n            div.style.zIndex = DIV_TOUCH_ZINDEX;\n            div.style.borderStyle = 'none';\n\n            div.addEventListener('click', this._onClick.bind(this));\n            div.addEventListener('focus', this._onFocus.bind(this));\n            div.addEventListener('focusout', this._onFocusOut.bind(this));\n        }\n\n        if (displayObject.accessibleTitle)\n        {\n            div.title = displayObject.accessibleTitle;\n        }\n        else if (!displayObject.accessibleTitle && !displayObject.accessibleHint)\n        {\n            div.title = `displayObject ${this.tabIndex}`;\n        }\n\n        if (displayObject.accessibleHint)\n        {\n            div.setAttribute('aria-label', displayObject.accessibleHint);\n        }\n\n        //\n\n        displayObject._accessibleActive = true;\n        displayObject._accessibleDiv = div;\n        div.displayObject = displayObject;\n\n        this.children.push(displayObject);\n        this.div.appendChild(displayObject._accessibleDiv);\n        displayObject._accessibleDiv.tabIndex = displayObject.tabIndex;\n    }\n\n    /**\n     * Maps the div button press to pixi's InteractionManager (click)\n     *\n     * @private\n     * @param {MouseEvent} e - The click event.\n     */\n    _onClick(e)\n    {\n        const interactionManager = this.renderer.plugins.interaction;\n\n        interactionManager.dispatchEvent(e.target.displayObject, 'click', interactionManager.eventData);\n    }\n\n    /**\n     * Maps the div focus events to pixis InteractionManager (mouseover)\n     *\n     * @private\n     * @param {FocusEvent} e - The focus event.\n     */\n    _onFocus(e)\n    {\n        const interactionManager = this.renderer.plugins.interaction;\n\n        interactionManager.dispatchEvent(e.target.displayObject, 'mouseover', interactionManager.eventData);\n    }\n\n    /**\n     * Maps the div focus events to pixis InteractionManager (mouseout)\n     *\n     * @private\n     * @param {FocusEvent} e - The focusout event.\n     */\n    _onFocusOut(e)\n    {\n        const interactionManager = this.renderer.plugins.interaction;\n\n        interactionManager.dispatchEvent(e.target.displayObject, 'mouseout', interactionManager.eventData);\n    }\n\n    /**\n     * Is called when a key is pressed\n     *\n     * @private\n     * @param {KeyboardEvent} e - The keydown event.\n     */\n    _onKeyDown(e)\n    {\n        if (e.keyCode !== KEY_CODE_TAB)\n        {\n            return;\n        }\n\n        this.activate();\n    }\n\n    /**\n     * Is called when the mouse moves across the renderer element\n     *\n     * @private\n     */\n    _onMouseMove()\n    {\n        this.deactivate();\n    }\n\n    /**\n     * Destroys the accessibility manager\n     *\n     */\n    destroy()\n    {\n        this.div = null;\n\n        for (let i = 0; i < this.children.length; i++)\n        {\n            this.children[i].div = null;\n        }\n\n        window.document.removeEventListener('mousemove', this._onMouseMove);\n        window.removeEventListener('keydown', this._onKeyDown);\n\n        this.pool = null;\n        this.children = null;\n        this.renderer = null;\n    }\n}\n\ncore.WebGLRenderer.registerPlugin('accessibility', AccessibilityManager);\ncore.CanvasRenderer.registerPlugin('accessibility', AccessibilityManager);\n"]}